// Content to continue with the simple solution after line 579...